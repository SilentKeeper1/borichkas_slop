<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Äî Borichkas slop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
      color: #212529;
    }
    .container {
      padding-top: 3rem;
      padding-bottom: 3rem;
    }
    h1 {
      text-align: center;
      font-size: 2.5rem;
      color: #dc3545; /* –ß–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
      margin-bottom: 2.5rem;
    }
    .section-title {
      margin: 40px 0 20px;
      text-align: center;
      font-size: 2rem;
    }

    /* –°—Ç–∏–ª—ñ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è */
    .table {
      background-color: #fff;
      border-radius: 10px;
      overflow: hidden; /* –©–æ–± –∑–∞–∫—Ä—É–≥–ª–µ–Ω—ñ –∫—É—Ç–∏ –±—É–ª–∏ –≤–∏–¥–Ω–æ */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    }
    .table thead {
      background-color: #e9ecef; /* –°–≤—ñ—Ç–ª—ñ—à–∏–π —Ñ–æ–Ω –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü—ñ */
    }
    .table th {
      padding: 1rem;
      font-weight: bold;
      color: #343a40;
    }
    .table td {
      padding: 1rem;
    }
    .table img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 8px;
    }

    /* –°—Ç–∏–ª—ñ –¥–ª—è —Ñ–æ—Ä–º–∏ */
    .form-label {
      font-weight: 600;
      color: #495057;
      margin-bottom: 0.5rem;
    }
    .form-control {
      border-radius: 0.5rem;
      padding: 0.75rem 1rem;
      border: 1px solid #ced4da;
    }
    .form-control:focus {
      border-color: #80bdff;
      box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
    }

    /* –°—Ç–∏–ª—ñ –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—Ä–æ –∑–æ–Ω—É –¥–æ—Å—Ç–∞–≤–∫–∏ */
    #zoneWarning, #zoneSuccess, #modalZoneWarning, #modalZoneSuccess {
      font-weight: bold;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      margin-top: 1rem;
    }
    #zoneWarning, #modalZoneWarning {
      color: #dc3545;
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
    }
    #zoneSuccess, #modalZoneSuccess {
      color: #28a745;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
    }

    /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    .btn {
      transition: all 0.2s ease-out;
      font-weight: 600;
      padding: 10px 20px;
      border-radius: 0.5rem;
    }

    /* –°—Ç–∏–ª—ñ —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –ó–ï–õ–ï–ù–ò–• –∫–Ω–æ–ø–æ–∫ (btn-success) */
    .btn-success {
      background-color: #28a745;
      border-color: #28a745;
      box-shadow: 0 2px 5px rgba(40, 167, 69, 0.2);
    }
    .btn-success:hover {
      background-color: #218838;
      border-color: #1e7e34;
      transform: scale(1.02);
      box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
    }
    .btn-success:active {
      transform: scale(0.95);
      background-color: #1e7e34;
      border-color: #1c7430;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    .btn-success:focus {
        outline: none;
        box-shadow: 0 0 0 0.25rem rgba(40, 167, 69, 0.25);
    }

    /* –°—Ç–∏–ª—ñ —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –ß–ï–†–í–û–ù–ò–• –∫–Ω–æ–ø–æ–∫ (btn-danger) */
    .btn-danger {
      background-color: #dc3545;
      border-color: #dc3545;
      box-shadow: 0 2px 5px rgba(220, 53, 69, 0.2);
    }
    .btn-danger:hover {
      background-color: #c82333;
      border-color: #bd2130;
      transform: scale(1.02);
      box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
    }
    .btn-danger:active {
      transform: scale(0.95);
      background-color: #bd2130;
      border-color: #b21f2d;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    .btn-danger:focus {
        outline: none;
        box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
    }

    /* –°—Ç–∏–ª—ñ —Ç–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –¥–ª—è –°–Ü–†–ò–• –∫–Ω–æ–ø–æ–∫ (btn-outline-secondary / btn-secondary) */
    .btn-outline-secondary, .btn-secondary {
      background-color: transparent;
      border-color: #6c757d;
      color: #6c757d;
      box-shadow: none;
    }
    .btn-outline-secondary:hover, .btn-secondary:hover {
      background-color: #6c757d;
      border-color: #6c757d;
      color: #fff;
      transform: scale(1.02);
      box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
    }
    .btn-outline-secondary:active, .btn-secondary:active {
      transform: scale(0.95);
      background-color: #5a6268;
      border-color: #545b62;
      color: #fff;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    .btn-outline-secondary:focus, .btn-secondary:focus {
        outline: none;
        box-shadow: 0 0 0 0.25rem rgba(108, 117, 125, 0.25);
    }

    /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–∞—Ä—Ç–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ */
    #map {
      height: 400px;
      width: 100%;
      margin-top: 2rem;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08); /* –¢—ñ–Ω—å –¥–ª—è –∫–∞—Ä—Ç–∏ */
    }
    .note {
      margin-top: 1rem;
      font-style: italic;
      color: #555;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1>üßæ –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h1>

    {% if not cart %}
      <div class="alert alert-info">
        –í–∞—à –∫–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π. <a href="{{ url_for('menu') }}">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –º–µ–Ω—é</a>
      </div>
    {% else %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>–ù–∞–∑–≤–∞</th>
              <th>–¶—ñ–Ω–∞</th>
              <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
              <th>–°—É–º–∞</th>
            </tr>
          </thead>
          <tbody>
            {% for item in cart %}
            <tr>
              <td>{{ item.name }}</td>
              <td>{{ item.price }} ‚Ç¥</td>
              <td>{{ item.quantity }}</td>
              <td>{{ item.price * item.quantity }} ‚Ç¥</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="d-flex justify-content-between align-items-center mt-4 p-3 border-top border-bottom bg-light rounded">
        <h4>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞: <span class="text-success fw-bold">{{ total }} ‚Ç¥</span></h4>
      </div>

      <hr class="my-5">

      <form method="POST" action="{{ url_for('create_order') }}" class="mt-4 p-4 bg-white rounded shadow-sm">
        <h3 class="mb-4 text-center">–í–∞—à—ñ –¥–∞–Ω—ñ –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏</h3>
        <div class="mb-3">
          <label for="addressInput" class="form-label">–ê–¥—Ä–µ—Å–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
          <input type="text" name="address" id="addressInput" class="form-control" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ö–∏—ó–≤, –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫ 10" required>
        </div>
        <div class="mb-3">
          <label for="phoneInput" class="form-label">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É:</label>
          <input type="tel" name="phone" id="phoneInput" class="form-control" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 050 XXX XX XX" required>
        </div>

        <p class="mt-4 text-center">–ü–µ—Ä–µ–¥ —Ç–∏–º —è–∫ –≤–ø–∏—Å—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–æ—Å—Ç–∞–≤–∫–∏, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –º–∏ –¥–æ –≤–∞—Å –¥–æ—Å—Ç–∞–≤–ª—è—î–º–æ:</p>
        <div class="text-center">
            <button type="button" class="btn btn-danger mb-3" data-bs-toggle="modal" data-bs-target="#deliveryZoneModal">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ–∫—Ä–∏—Ç—Ç—è</button>
        </div>


        <div id="zoneWarning" class="text-danger mt-2" style="display:none;">
          ‚ö†Ô∏è –í–∞—à–∞ –∞–¥—Ä–µ—Å–∞ –ø–æ–∑–∞ –∑–æ–Ω–æ—é –¥–æ—Å—Ç–∞–≤–∫–∏!
        </div>
        <div id="zoneSuccess" class="text-success mt-2" style="display:none;">
          ‚úÖ –ê–¥—Ä–µ—Å–∞ –≤ –º–µ–∂–∞—Ö –∑–æ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏.
        </div>

        <div class="d-flex flex-column flex-sm-row align-items-center justify-content-center gap-3 mt-4">
          <a href="{{ url_for('menu') }}" class="btn btn-outline-secondary w-100 w-sm-auto">–ù–∞–∑–∞–¥ –¥–æ –º–µ–Ω—é</a>
          <button type="submit" class="btn btn-success w-100 w-sm-auto">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
        </div>
      </form>
    {% endif %}

    <div class="modal fade" id="deliveryZoneModal" tabindex="-1" aria-labelledby="deliveryZoneModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deliveryZoneModalLabel">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–æ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="modalAddressInput" class="form-label">–í–≤–µ–¥—ñ—Ç—å –∞–¥—Ä–µ—Å—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:</label>
              <input type="text" id="modalAddressInput" class="form-control" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ö–∏—ó–≤, –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫ 10">
              <button class="btn btn-danger mt-2" onclick="checkDeliveryZone()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∞–¥—Ä–µ—Å—É</button>
            </div>
            <div id="modalZoneWarning" class="text-danger mt-2" style="display:none;">
              ‚ö†Ô∏è –í–∞—à–∞ –∞–¥—Ä–µ—Å–∞ –ø–æ–∑–∞ –∑–æ–Ω–æ—é –¥–æ—Å—Ç–∞–≤–∫–∏!
            </div>
            <div id="modalZoneSuccess" class="text-success mt-2" style="display:none;">
              ‚úÖ –ê–¥—Ä–µ—Å–∞ –≤ –º–µ–∂–∞—Ö –∑–æ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏.
            </div>
            <div id="map" class="mt-3"></div>
            <div class="note">
              ‚ö†Ô∏è –¢–∏–º—á–∞—Å–æ–≤–æ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è—î–º–æ –Ω–∞ –æ–∫—É–ø–æ–≤–∞–Ω—ñ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—ó –£–∫—Ä–∞—ó–Ω–∏. –ú–∏ –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –ø—ñ—Å–ª—è –¥–µ–æ–∫—É–ø–∞—Ü—ñ—ó ‚ù§Ô∏èüá∫üá¶
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä–∏—Ç–∏</button>
          </div>
        </div>
      </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

<script>
  const regions = {
    'green': [
      ['–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.2331, 28.4682],
      ['–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 50.7472, 25.3254],
      ['–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 48.4647, 35.0462],
      ['–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 50.2649, 28.6767],
      ['–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 48.6208, 22.2879],
      ['–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 47.8388, 35.1396],
      ['–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 48.9226, 24.7111],
      ['–ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 50.4017, 30.2520],
      ['–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 48.5080, 32.2597],
      ['–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.8397, 24.0297],
      ['–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 46.9750, 31.9946],
      ['–û–¥–µ—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 46.4825, 30.7233],
      ['–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.5883, 34.5514],
      ['–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 50.6199, 26.2516],
      ['–°—É–º—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 50.9077, 34.7981],
      ['–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.5535, 25.5948],
      ['–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.9935, 36.2304],
      ['–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 46.6354, 32.6169],
      ['–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.4215, 26.9965],
      ['–ß–µ—Ä–∫–∞—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 49.4444, 32.0598],
      ['–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 48.2915, 25.9358],
      ['–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å', 51.4982, 31.2893],
      ['–ö—Ä–∏–≤–∏–π –†—ñ–≥ (–º—ñ—Å—Ç–æ)', 47.9105, 33.3918]
    ],
    'blue': [
      ['–î–æ–ª—å–Ω—î—à–ª—å–æ–Ω—Å—å–∫–µ', 51.1079, 17.0385],
      ['–ö—É—è–≤—Å—å–∫–æ-–ü–æ–º–æ—Ä—Å—å–∫–µ', 53.0138, 18.5984],
      ['–õ—é–±—É—Å—å–∫–µ', 52.2456, 15.2259],
      ['–õ–æ–¥–∑—å–∫–µ', 51.7592, 19.4550],
      ['–ú–∞–∑–æ–≤–µ—Ü—å–∫–µ', 52.2297, 21.0122],
      ['–û–ø–æ–ª—å—Å—å–∫–µ', 50.6751, 17.9213],
      ['–ü—ñ–¥–∫–∞—Ä–ø–∞—Ç—Å—å–∫–µ', 49.7831, 22.7671],
      ['–ü—ñ–¥–ª—è—Å—å–∫–µ', 52.7047, 23.2525],
      ['–ü–æ–º–æ—Ä—Å—å–∫–µ', 54.3520, 18.6466],
      ['–°–≤–µ–Ω—Ç–æ–∫—à–∏—Å—å–∫–µ', 50.8661, 20.6286],
      ['–í–∞—Ä–º—ñ–Ω—Å—å–∫–æ-–ú–∞–∑—É—Ä—Å—å–∫–µ', 53.7784, 20.4801],
      ['–í–µ–ª–∏–∫–æ–ø–æ–ª—å—Å—å–∫–µ', 52.4064, 16.9252],
      ['–ó–∞—Ö—ñ–¥–Ω–æ–ø–æ–º–æ—Ä—Å—å–∫–µ', 53.4285, 14.5528],
      ['–õ—é–±–ª—ñ–Ω—Å—å–∫–µ', 51.2465, 22.5684],
      ['–ú–∞–ª–æ–ø–æ–ª—å—Å—å–∫–µ', 50.0647, 19.9450],
      ['–°—ñ–ª–µ–∑—å–∫–µ', 50.2649, 19.0238]
    ],
    'red': [
      ['Region Hovedstaden', 55.6759, 12.5655],
      ['Region Sj√¶lland', 55.4028, 11.3546],
      ['Region Syddanmark', 55.3556, 10.3450],
      ['Region Midtjylland', 56.1629, 9.5870],
      ['Region Nordjylland', 57.0488, 9.9217]
    ],
    'white': [
      ['–°—Ç–∞–Ω—Ü—ñ—è "–ê–∫–∞–¥–µ–º—ñ–∫ –í–µ—Ä–Ω–∞–¥—Å—å–∫–∏–π"', -65.2510, -64.2610]
    ]
  };

  const deliveryZones = [];
  for (const [color, areas] of Object.entries(regions)) {
    areas.forEach(([name, lat, lon]) => {
      deliveryZones.push({ name, lat, lon });
    });
  }

  let mapInstance = null;

  function initMap() {
    if (mapInstance) {
      mapInstance.remove();
    }
    mapInstance = L.map('map').setView([52, 20], 5);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 10,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(mapInstance);

    for (const [color, areas] of Object.entries(regions)) {
      areas.forEach(([name, lat, lon]) => {
        const radius = color === 'green' ? 50000 : color === 'blue' ? 35000 : color === 'red' ? 25000 : 20000;
        L.circle([lat, lon], {
          color,
          fillColor: color,
          fillOpacity: 0.2,
          radius
        }).addTo(mapInstance).bindPopup(name + (color === 'white' ? ' (–ê–Ω—Ç–∞—Ä–∫—Ç–∏–¥–∞)' : ''));
      });
    }
  }

  const deliveryZoneModal = document.getElementById('deliveryZoneModal');
  deliveryZoneModal.addEventListener('shown.bs.modal', function () {
    initMap();
    mapInstance.invalidateSize();
  });

  async function checkDeliveryZone() {
    const input = document.getElementById('modalAddressInput').value;
    const warning = document.getElementById('modalZoneWarning');
    const success = document.getElementById('modalZoneSuccess');

    warning.style.display = 'none';
    success.style.display = 'none';

    if (!input.trim()) return;

    try {
      const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(input)}`);
      const data = await response.json();

      if (!data.length) {
        warning.textContent = '‚ùå –ê–¥—Ä–µ—Å—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!';
        warning.style.display = 'block';
        return;
      }

      const userLat = parseFloat(data[0].lat);
      const userLon = parseFloat(data[0].lon);

      if (mapInstance) {
        L.marker([userLat, userLon]).addTo(mapInstance)
          .bindPopup(`–í–∞—à–∞ –∞–¥—Ä–µ—Å–∞: ${input}`).openPopup();
        mapInstance.setView([userLat, userLon], 9);
      }

      const inZone = deliveryZones.some(region => {
        const dLat = region.lat - userLat;
        const dLon = region.lon - userLon;
        const distance = Math.sqrt(dLat * dLat + dLon * dLon) * 111000;

        const radius = region.name.includes('–£–∫—Ä–∞—ó–Ω–∞') ? 50000 :
                       region.name.includes('–ü–æ–ª—å—â–∞') ? 35000 :
                       region.name.includes('–î–∞–Ω—ñ—è') ? 25000 : 20000;

        return distance <= radius;
      });

      if (inZone) {
        success.style.display = 'block';
      } else {
        warning.style.display = 'block';
      }

    } catch (err) {
      warning.textContent = '‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ –∞–¥—Ä–µ—Å–∏!';
      warning.style.display = 'block';
    }
  }
</script>

</body>
</html>